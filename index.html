<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embedded Finals</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <nav class="nav-bar">
           <h1 class="title">Deck Editor</h1>
        </nav>
    </header>
    <main>
        <div class="container">
            <div class="left-container">
                <div class="left">
                    <h2 class="card-name-left" id="left-card-name">Card Name</h2>
                    <div class="card-picture" id="left-card-picture">
                        <img src="images/card.png" alt="Card Image" id="left-card-image">
                      </div>
                    <p class="card-type" id="left-card-type">Card Type</p>
                    <p class="card-description" id="left-card-description">Card description</p>
                </div>
            </div>
            <div class="decks">
                <div class="middle">
                    <h1 class="main-deck-title">Main Deck</h1>
                    <div class="main-deck"> </div>
                </div>
                <div class="extra">
                    <h1 class="extra-deck-title">Extra Deck</h1>
                    <div class="extra-deck"> </div>
                </div>
                <div class="side">
                    <h1 class="side-deck-title">Side Deck</h1>
                    <div class="side-deck"> </div>
                </div>
            </div>
            <div class="right-container">
                <div class="right">
                    <input class="card-name-right" type="search" name="search" placeholder="Enter Card Name...">
                    <div class="filter-card-type">
                        <select class="select-card-type">
                                <option disabled selected value="">Select Card Type</option>
                                <option value="Monster">Monster</option>
                                <option value="Trap">Trap</option>
                                <option value="Spell">Spell</option>
                                <option value="Fusion">Fusion</option>
                        </select>
                    </div>
                    <div class="search-results">
                        <div class="search-result" data-card='{"name": "Card Name", "image": "card1.jpg", "description": "Description"}' draggable="true">
                            <img src="card1.jpg" alt="Card Name">
                            <p>Card Name</p>
                        </div>
                    </div>
                </div>
            </div>  
        </div>
    </main>
    <script>
        // Get references to the elements
        const leftCardName = document.getElementById('left-card-name');
        const leftCardPicture = document.getElementById('left-card-picture');
        const leftCardDescription = document.getElementById('left-card-description');
        const leftCardType = document.getElementById('left-card-type');
        const searchInput = document.querySelector('.card-name-right');
        const searchResults = document.querySelector('.search-results');
        const selectCardType = document.querySelector('.select-card-type');
        const mainDeck = document.querySelector('.main-deck');
        const extraDeck = document.querySelector('.extra-deck');
        const sideDeck = document.querySelector('.side-deck');
        
        // Sample data for demonstration (replace with your actual data)
        const cardData = [
            {
                name: 'Black Luster Soldier',
                image: 'images/BlackLusterSoldier.png',
                description: 'The strongest warrior, it has the same capabilities as Blue-Eyes White Dragon.',
                type: 'Monster',
            },
            {
                name: 'Blue-Eyes White Dragon',
                image: 'images/BlueEyesWhiteDragon.png',
                description: 'This legendary dragon is a powerful engine of destruction. Virtually invincible, very few have faced this awesome creature and lived to tell the tale.',
                type: 'Spell',
            },
            {
                name: 'Rabidragon',
                image: 'images/Rabidragon.png',
                description: 'It is a snowfield-dwelling, giant-ear-sporting, super-acoustic, snowball-shaped mutant dragon! There is no way anybody can escape.',
                type: 'Trap',
            },
            {
                name: 'Gogiga Gagagigo',
                image: 'images/GogigaGagagigo.png',
                description: 'His soul long-since collapsed, his body recklessly continues onward, driven by a lust for more power. He no longer resembles his former self....',
                type: 'Trap',
            },
            {
                name: 'Spiral Serpent',
                image: 'images/SpiralSerpent.png',
                description: 'When huge whirlpools lay cities asunder, it is the hunger of this sea serpent at work. No one has ever escaped its dreaded Spiral Wave to accurately describe the terror they experienced.',
                type: 'Monster',
            },
            // Add more card data as needed
        ];

        // Function to update the left container with card information
        function updateLeftContainer(card) {
            leftCardName.textContent = card.name;
            leftCardPicture.style.backgroundImage = `url(${card.image})`;
            leftCardDescription.textContent = card.description;
        }

        function updateLeftContainer(category) {
            leftCardName.textContent = card.name;
            leftCardPicture.style.backgroundImage = `url(${card.image})`;
            leftCardDescription.textContent = card.description;
        }

        // Function to search for cards and display results
        function searchCards(query, selectedType) {
            // Clear previous search results
            searchResults.innerHTML = '';

            // Filter cards based on the query and selected type
            const filteredCards = cardData.filter((card) => {
                const nameMatches = card.name.toLowerCase().includes(query.toLowerCase());
                const typeMatches = !selectedType || card.type === selectedType; // Filter by type if selected
                return nameMatches && typeMatches;
            });

            // If no results were found, display a message
            if (filteredCards.length === 0) {
                searchResults.innerHTML = '<p>No results found.</p>';
                return;
            }

            // Generate HTML for search results
            const resultsHTML = filteredCards.map(
                (card) =>
                `<div class="search-result" data-card='${JSON.stringify(card)}' draggable="true">
                    <img src="${card.image}" alt="${card.name}">
                    <p>${card.name}</p>
                </div>`
            );

            // Display search results
            searchResults.innerHTML = resultsHTML.join('');

            // Add click event listeners to search results
            const resultElements = document.querySelectorAll('.search-result');
            resultElements.forEach((element) => {
                element.addEventListener('click', () => {
                    const card = JSON.parse(element.getAttribute('data-card'));
                    updateLeftContainer(card);
                });
            });

            // Add dragstart event listeners to search results
            resultElements.forEach((element) => {
                element.addEventListener('dragstart', (event) => {
                    const cardData = JSON.stringify(JSON.parse(element.getAttribute('data-card')));
                    event.dataTransfer.setData('text/plain', cardData);
                });
            });
            
        }

        selectCardType.addEventListener('change', (event) => {
                const selectedType = event.target.value;
                const query = searchInput.value;
                searchCards(query, selectedType);
            });
        // Add an input event listener to the search input
        searchInput.addEventListener('input', (event) => {
            const query = event.target.value;
            searchCards(query);
        });

        // Initial display of cards (you can remove this if not needed)
        searchCards('');

        function handleCardDrop(event, deck) {
            event.preventDefault();

            // Get the card data from the dropped element
            const cardData = JSON.parse(event.dataTransfer.getData('text/plain'));

            // Create a new card element for the deck
            const deckCard = document.createElement('div');
            deckCard.classList.add('main-deck-card');

            // Create an <img> element for the card image
            const cardImage = document.createElement('img');
            cardImage.src = cardData.image;
            cardImage.alt = cardData.name;

            // Apply object-fit: cover to the card image
            cardImage.style.objectFit = 'cover';

            // Add the card image to the deck card
            deckCard.appendChild(cardImage);

            // Add the card to the deck
            deck.appendChild(deckCard);

            // Add a click event listener to remove the card from the deck
            deckCard.addEventListener('click', () => {
            deck.removeChild(deckCard);
            });
        }

        // Add event listeners for the dragover event on all decks
        mainDeck.addEventListener('dragover', (event) => {
            event.preventDefault();
        });
        extraDeck.addEventListener('dragover', (event) => {
            event.preventDefault();
        });
        sideDeck.addEventListener('dragover', (event) => {
            event.preventDefault();
        });

  // Add event listeners for the drop event on all decks
  mainDeck.addEventListener('drop', (event) => handleCardDrop(event, mainDeck));
  extraDeck.addEventListener('drop', (event) => handleCardDrop(event, extraDeck));
  sideDeck.addEventListener('drop', (event) => handleCardDrop(event, sideDeck));

                function updateLeftContainer(card) {
        leftCardName.textContent = card.name;
        const leftCardImage = document.getElementById('left-card-image');
        leftCardImage.src = card.image; // Set the src attribute of the img tag
        leftCardType.textContent = card.type;
        leftCardDescription.textContent = card.description;
        }
    </script>
</body>
</html>
        